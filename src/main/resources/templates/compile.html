<!DOCTYPE html>
<html lang="zh-CN" layout:decorate="~{layout/decorate}">
<head>
    <title>在线调试</title>
	<meta charset="UTF-8" />
	<meta name="renderer" content="webkit" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
	<!-- 在线编辑器插件样式 -->
    <link th:href="@{/webjars/codemirror/lib/codemirror.css}" rel="stylesheet" />
    <!-- 在线编辑器插件js -->
    <script th:src="@{/webjars/codemirror/lib/codemirror.js}"></script>
    <!-- 代码高亮 -->
    <script th:src="@{/webjars/codemirror/mode/groovy/groovy.js}"></script>
    <!-- 编辑器主题 -->
    <!-- <link th:href="@{/webjars/codemirror/theme/dracula.css}" rel="stylesheet" /> -->
    <!-- 全屏 -->
    <link th:href="@{/webjars/codemirror/addon/display/fullscreen.css}" rel="stylesheet" />
    <!-- 代码自动完成 -->
    <link th:href="@{/webjars/codemirror/addon/hint/show-hint.css}" rel="stylesheet" />
    <!-- 代码检测 -->
    <link th:href="@{/webjars/codemirror/addon/lint/lint.css}" rel="stylesheet" />
    <link th:href="@{/webjars/codemirror/addon/scroll/simplescrollbars.css}" rel="stylesheet" />

    <!-- 代码自动完成 -->
    <script th:src="@{/webjars/codemirror/addon/hint/show-hint.js}"></script>
    <script th:src="@{/webjars/codemirror/addon/hint/css-hint.js}"></script>
    <script th:src="@{/webjars/codemirror/addon/hint/html-hint.js}"></script>
    <script th:src="@{/webjars/codemirror/addon/hint/javascript-hint.js}"></script>
    <script th:src="@{/webjars/codemirror/addon/hint/xml-hint.js}"></script>

    <!-- 需要高亮的代码 -->
    <script th:src="@{/webjars/codemirror/mode/xml/xml.js}"></script>
    <script th:src="@{/webjars/codemirror/mode/javascript/javascript.js}"></script>
    <script th:src="@{/webjars/codemirror/mode/css/css.js}"></script>
    <script th:src="@{/webjars/codemirror/mode/htmlmixed/htmlmixed.js}"></script>

    <!-- 开启活动行 -->
    <script th:src="@{/webjars/codemirror/addon/selection/active-line.js}"></script>
    <!-- 闭合标签 -->
    <script th:src="@{/webjars/codemirror/addon/edit/closetag.js}"></script>
    <!-- 全屏 -->
    <script th:src="@{/webjars/codemirror/addon/display/fullscreen.js}"></script>
    <!-- 代码检测 -->
    <!--<script src="https://unpkg.com/jshint@2.9.6/dist/jshint.js"></script>-->
    <!--<script src="https://unpkg.com/jsonlint@1.6.3/web/jsonlint.js"></script>-->
    <!--<script src="https://unpkg.com/csslint@1.0.5/dist/csslint.js"></script>-->
    <!--<script th:src="@{/webjars/codemirror/addon/lint/lint.js}"></script>-->
    <!--<script th:src="@{/webjars/codemirror/addon/lint/css-lint.js}"></script>-->
    <!--<script th:src="@{/webjars/codemirror/addon/lint/json-lint.js}"></script>-->
    <!--<script th:src="@{/webjars/codemirror/addon/lint/html-lint.js}"></script>-->
    <script th:src="@{/webjars/codemirror/addon/lint/javascript-lint.js}"></script>
    <!-- 单词匹配全局高亮 -->
    <script th:src="@{/webjars/codemirror/addon/scroll/annotatescrollbar.js}"></script>
    <script th:src="@{/webjars/codemirror/addon/search/matchesonscrollbar.js}"></script>
    <script th:src="@{/webjars/codemirror/addon/search/searchcursor.js}"></script>
    <script th:src="@{/webjars/codemirror/addon/search/match-highlighter.js}"></script>
    <!-- 滚动条 -->
    <script th:src="@{/webjars/codemirror/addon/scroll/simplescrollbars.js}"></script>
    <!--&lt;!&ndash;匹配开始和结束标签&ndash;&gt;-->
    <!--<script th:src="@{/webjars/codemirror/addon/fold/xml-fold.js}"></script>-->
    <!--<script th:src="@{/webjars/codemirror/addon/edit/matchtags.js}"></script>-->
    
    <style type="text/css">
		.CodeMirror {
			height: 100%;
		}
		
		#preview {
			display: block;
			overflow: hidden;
			border: 0;
			min-width: 100px;
			width: 100%;
			min-height: 300px;
			height: 100%;
			background-color: #fff;
		}
		
		.CodeMirror-focused .cm-matchhighlight {
			background-image:
				url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAFklEQVQI12NgYGBgkKzc8x9CMDAwAAAmhwSbidEoSQAAAABJRU5ErkJggg==);
			background-position: bottom;
			background-repeat: repeat-x;
		}
		
		.cm-matchhighlight {
			background-color: lightgreen
		}
		
		.CodeMirror-selection-highlight-scrollbar {
			background-color: green
		}
</style>
</head>
<body layout:fragment="content">
	<!--1.左右两列布局-->
	<div class="easyui-layout" data-options="fit:true">
		<!--1.1 代码编辑器-->
		<div data-options="region:'west',
				split:true,
				border:false,
				width:'50%'">
			<div id="editorPanel" class="easyui-panel"
				data-options="iconCls:'fa fa-file-code-o',
					title:' 代 码 ',
					fit:true,
					footer:'#editorPanelToolbar'">
				<textarea id="code" name="code" class="form-control" style="height: 100%;"></textarea>
			</div>
		</div>
		<!--1.2 效果预览-->
		<div data-options="region:'center',
				border:false,
				iconCls:'fa fa-eye',
				split:true">
			<div style="height: 100%">
				<div id="previewPanel" 
					class="easyui-panel"
					data-options="iconCls:'fa fa-eye',
						title:' 预 览 ',
						fit:true">
					<iframe id="preview" frameborder="0"></iframe>
				</div>
			</div>
		</div>
	</div>
	<!--2.代码编辑器工具栏-->
	<div id="editorPanelToolbar">
		<div class="myui-fluid" style="text-align: right">
			<a class="easyui-linkbutton myui-btn-green"
				data-options="iconCls:'fa fa-play-circle',
					onClick:runHtml"> 运 行
			</a>
		</div>
	</div>
<!--js脚本-->
<script type="text/javascript">
	var editor = CodeMirror.fromTextArea(document.getElementById("code"), {
		mode: "text/html",
		lineNumbers: true,
		styleActiveLine: true,
		autoCloseTags: true,
		scrollbarStyle: "simple",
		gutters: [ "CodeMirror-lint-markers" ],
		highlightSelectionMatches: {
			showToken: /\w/,
			annotateScrollbar: true
		},
		extraKeys: {
			"Ctrl-/": "autocomplete",
			"Ctrl-J": "toMatchingTag",
			"F11": function (cm) {
				cm.setOption("fullScreen", !cm.getOption("fullScreen"));
			},
			"Esc": function (cm) {
				if (cm.getOption("fullScreen")) {
					cm.setOption("fullScreen", false);
				}
			}
		}
	});
	
	function runHtml() {
		var previewFrame = document.getElementById("preview");
		var preview = previewFrame.contentDocument || previewFrame.contentWindow.document;
		preview.open();
		preview.write(editor.getValue());
		preview.close();
	}
	
	$(function(){
		runHtml();
	});
</script>
</body>
</html>