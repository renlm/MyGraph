<!DOCTYPE html>
<html lang="zh-CN" layout:decorate="~{layout/hadmin}">
<head>
	<title>更新记录</title>
</head>
<body layout:fragment="content" class="gray-bg">
	<div class="wrapper wrapper-content">
		<div class="row">
			<div class="col-sm-3">
				<div class="ibox">
					<div class="ibox-content">
						<button type="button" class="btn btn-block btn-primary compose-mail" data-toggle="modal" data-target="#dsModal">
                        	新建
                       	</button>
						<div class="space-25"></div>
						<div class="hr-line-dashed"></div>
						<h5>已支持数据库</h5>
						<ul class="category-list" style="padding: 0;">
							<li>
								<a href="javascript:void(0);">
									<i class="fa fa-circle text-danger"></i> MySQL
								</a>
							</li>
							<li>
								<a href="javascript:void(0);">
									<i class="fa fa-circle text-primary"></i> PostgreSQL
								</a>
							</li>
						</ul>
						<div class="hr-line-dashed"></div>
						<div class="input-group">
							<input type="text" placeholder="关键字" class="input input-sm form-control" /> 
							<span class="input-group-btn">
								<button type="button" class="btn btn-sm btn-white">
									<i class="fa fa-search"></i> 搜索
								</button>
							</span>
						</div>
						<ul class="sortable-list connectList agile-list">
							<li class="warning-element">jdbc:postgresql://renlm.cn:5432/renlm
								<div class="agile-detail">
									<a href="#" class="pull-right btn btn-xs btn-info">
										<i class="fa fa-paste"></i> 编辑
									</a> 
									<i class="fa fa-clock-o"></i> 2015.09.01
								</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="col-sm-9 animated fadeInRight">
			
			</div>
		</div>
	</div>
	<div class="modal" id="dsModal" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content animated flipInY">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">
						<span aria-hidden="true">&times;</span>
						<span class="sr-only">Close</span>
					</button>
					<h4 class="modal-title">新建数据源</h4>
				</div>
				<div class="modal-body">
					<form class="form-horizontal m-t-none" id="dsForm">
						<div class="form-group">
							<label class="col-sm-3 control-label">JDBC链接</label>
							<div class="col-sm-8">
								<input name="url" type="text" class="form-control" autocomplete="off" data-vmsg="必填" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">Schema</label>
							<div class="col-sm-8">
								<input name="schema" type="text" class="form-control" autocomplete="off" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">访问账号</label>
							<div class="col-sm-8">
								<input name="username" type="text" class="form-control" autocomplete="off" data-vmsg="必填" />
							</div>
						</div>
						<div class="form-group">
							<label class="col-sm-3 control-label">认证密码</label>
							<div class="col-sm-8">
								<input name="password" type="password" class="form-control" autocomplete="new-password" data-vmsg="必填" />
							</div>
						</div>
						<div class="form-group m-b-n-sm">
							<label class="col-sm-3 control-label">备注</label>
							<div class="col-sm-8">
								<textarea name="remark" class="form-control" rows="3"></textarea>
							</div>
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
					<button type="button" class="btn btn-primary" onclick="submitDsForm();">保存</button>
				</div>
			</div>
		</div>
	</div>
	<script th:src="@{/static/js/form.js}"></script>
	<script type="text/javascript">
		$(function () {
			/**
			 * 重置表单
			 */
			$("#dsModal").on("show.bs.modal", function () {
				$("#dsForm").clearform();
			}).on("hide.bs.modal", function () {
				$("#dsForm").clearform();
			});
		});
		/**
		 * 提交数据源表单
		 */
		function submitDsForm () {
			var dsForm = $("#dsForm");
			// 表单校验
			if(dsForm.valiform()) {
				var layerIndex = layer.load(2);
   				$.post(ctx + '/ds/ajax/save', 
   					dsForm.formJson(), 
   					function (resJson) {
   						layer.close(layerIndex);
						if(resJson.statusCode == 200) {
							$.toastrSuccess("数据源已添加");
							$("#dsModal").modal("hide");
			          	} else {
			          		
			        	}
					});				
			}
		}
	</script>
</body>
</html>